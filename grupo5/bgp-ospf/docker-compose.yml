version: '2.1'

services:
 

  b1:
    build: ./bgp/.
    volumes:
      - ./volumes/bgp/b2/zebra.conf:/etc/tp7/zebra.conf:ro
      - ./volumes/bgp/b2/ospf6d.conf:/etc/tp7/ospf6d.conf:ro
      - ./volumes/bgp/b2/bgpd.conf:/etc/tp7d/bgpd.conf:ro
      - ./volumes/bgp/supervisord.conf:/etc/tp7/supervisor/conf.d/supervisord.conf:ro
    image: bgp:20180426
    privileged: true
    ports:
      #admin
      - 10201:2601
      #ospf ipv6
      - 10203:2606d
      #bgp
      - 10204:2605
      -	80:80
    networks:
      redD:
        ipv6_address: 2001:d:1::10
      red3:
        ipv6_address: 2001:a:3::3

  r3:
    build: ./ospf/.
    volumes:
      - ./volumes/ospf/r4/zebra.conf:/etc/tp7/zebra.conf:ro
      - ./volumes/ospf/r4/ospf6d.conf:/etc/tp7/ospf6d.conf:ro
      - ./volumes/ospf/supervisord.conf:/etc/tp7/supervisor/conf.d/supervisord.conf:ro
    image: ospf:20180419
    privileged: true
    ports:
      #admin
      - 10014:2601
      #ospf ipv6
      - 10034:2606
    networks:
      red2:
        ipv6_address: 2001:a:2::10
      red3: 
	ipv6_address: 2001:a:3::4
     
  r5:
    build: ./ospf/.
    volumes:
      - ./volumes/ospf/r6/zebra.conf:/etc/tp7/zebra.conf:ro
      - ./volumes/ospf/r6/ospf6d.conf:/etc/tp7/ospf6d.conf:ro
      - ./volumes/ospf/supervisord.conf:/etc/tp7/supervisor/conf.d/supervisord.conf:ro
    image: ospf:20180419
    privileged: true
    ports:
      #admin
      - 10016:2601
      #ospf ipv6
      - 10036:2606
    networks:
      red3:
        ipv6_address: 2001:a:3::2
      red5:
        ipv6_address: 2001:a:5::20
      red7:
        ipv6_address: 2001:a:7::10

  r7:
    build: ./ospf/.
    volumes:
      - ./volumes/ospf/r8/zebra.conf:/etc/tp7/zebra.conf:ro
      - ./volumes/ospf/r8/ospf6d.conf:/etc/tp7/ospf6d.conf:ro
      - ./volumes/ospf/supervisord.conf:/etc/tp7/supervisor/conf.d/supervisord.conf:ro
    image: ospf:20180419
    privileged: true
    ports:
      #admin
      - 10018:2601
      #ospf ipv6
      - 10038:2606
    networks:
      red3:
        ipv6_address: 2001:a:3::5
      red6:
        ipv6_address: 2001:a:6::10
      red7:
        ipv6_address: 2001:a:7::20

  
  h11:
    build: ./ospf/.
    volumes:
      - ./volumes/ospf/supervisord.conf:/etc/tp7/supervisor/conf.d/supervisord.conf:ro
    image: ospf:20180419
    privileged: true
    ports:
      #admin
      - 10021:2601
      #ospf ipv6
      - 10041:2606
    networks:
      red5:
        ipv6_address: 2001:a:5::20

 
  h13:
    build: ./ospf/.
    volumes:
      - ./volumes/ospf/supervisord.conf:/etc/tp7/supervisor/conf.d/supervisord.conf:ro
    image: ospf:20180419
    privileged: true
    ports:
      #admin
      - 10023:2601
      #ospf ipv6
      - 10043:2606
    networks:
      red6:
        ipv6_address: 2001:a:6::20


networks:
  
  redD:
    driver: "bridge"
    enable_ipv6: true
    ipam:
      driver: default
      config:
        - subnet: 2001:d:1::/64
  red2:
    driver: "bridge"
    enable_ipv6: true
    ipam:
      driver: default
      config:
        - subnet: 2001:a:2::/64
  red3:
    driver: "bridge"
    enable_ipv6: true
    ipam:
      driver: default
      config:
        - subnet: 2001:a:3::/64
  
  red5:
    driver: "bridge"
    enable_ipv6: true
    ipam:
      driver: default
      config:
        - subnet: 2001:a:5::/64
  red6:
    driver: "bridge"
    enable_ipv6: true
    ipam:
      driver: default
      config:
        - subnet: 2001:a:6::/64
  red7:
    driver: "bridge"
    enable_ipv6: true
    ipam:
      driver: default
      config:
        - subnet: 2001:a:7::/64
 
